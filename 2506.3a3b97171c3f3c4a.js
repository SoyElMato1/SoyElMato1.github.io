"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2506],{2506:(H,p,c)=>{c.r(p),c.d(p,{HistorialCompraPageModule:()=>M});var g=c(177),l=c(4341),d=c(4742),u=c(6766),m=c(467),o=c(3953),f=c(3114);function h(r,i){1&r&&(o.j41(0,"div",24),o.EFF(1," El RUT es obligatorio y debe ser v\xe1lido. "),o.k0s())}function b(r,i){1&r&&(o.j41(0,"div",24),o.EFF(1," La contrase\xf1a es obligatoria. "),o.k0s())}function C(r,i){if(1&r&&(o.j41(0,"li"),o.EFF(1),o.k0s()),2&r){const s=i.$implicit;o.R7$(),o.Lme(" ",s.nombre,", Cant: ",s.cantidad," ")}}function F(r,i){if(1&r&&(o.j41(0,"tr")(1,"th",31),o.EFF(2),o.k0s(),o.j41(3,"td"),o.EFF(4),o.nI1(5,"date"),o.k0s(),o.j41(6,"td"),o.EFF(7),o.k0s(),o.j41(8,"td"),o.EFF(9),o.nI1(10,"currency"),o.k0s(),o.j41(11,"td"),o.EFF(12),o.k0s(),o.j41(13,"td")(14,"ul"),o.DNE(15,C,2,2,"li",30),o.k0s()()()),2&r){const s=i.$implicit,e=i.index,t=o.XpG(2);o.R7$(2),o.JRh(e+1),o.R7$(2),o.JRh(o.i5U(5,6,s.orden_date,"dd/MM/yyyy HH:mm")),o.R7$(3),o.JRh(t.rut),o.R7$(2),o.JRh(o.bMT(10,9,s.total)),o.R7$(3),o.JRh(s.pagado?"Pagado":"Rechazado"),o.R7$(3),o.Y8G("ngForOf",s.items)}}function v(r,i){if(1&r&&(o.j41(0,"div",25)(1,"h2",26),o.EFF(2,"Historial de Compras"),o.k0s(),o.j41(3,"div",27)(4,"table",28)(5,"thead")(6,"tr")(7,"th",29),o.EFF(8,"#"),o.k0s(),o.j41(9,"th",29),o.EFF(10,"Fecha"),o.k0s(),o.j41(11,"th",29),o.EFF(12,"Cliente"),o.k0s(),o.j41(13,"th",29),o.EFF(14,"Total"),o.k0s(),o.j41(15,"th",29),o.EFF(16,"Estado"),o.k0s(),o.j41(17,"th",29),o.EFF(18,"Productos"),o.k0s()()(),o.j41(19,"tbody"),o.DNE(20,F,16,11,"tr",30),o.k0s()()()()),2&r){const s=o.XpG();o.R7$(20),o.Y8G("ngForOf",s.orders)}}function P(r,i){1&r&&(o.j41(0,"div",32)(1,"p",33),o.EFF(2,"No tienes \xf3rdenes en tu historial"),o.k0s()())}const _=[{path:"",component:(()=>{var r;class i{constructor(e,t,a,n){this.formBuilder=e,this.toastController=t,this.router=a,this.productoService=n,this.orders=[],this.rut="",this.contrasena="",this.showPasswordHistorial=!1,this.cargando=!1,this.HistorialForm=this.formBuilder.group({rut:["",[l.k0.required,l.k0.pattern("^[0-9]+$"),l.k0.minLength(7),l.k0.maxLength(8)]],contrasena:["",[l.k0.required,l.k0.minLength(8),l.k0.maxLength(12)]]})}ngOnInit(){}togglePasswordVisibility(){this.showPasswordHistorial=!this.showPasswordHistorial}campo(e){return this.HistorialForm.get(e)}campoTocado(e){var t;return null===(t=this.HistorialForm.get(e))||void 0===t?void 0:t.touched}getErrorMessage(e){var t,a;const n=this.HistorialForm.get(e);return null!=n&&n.hasError("required")?"Este campo es obligatorio.":null!=n&&n.hasError("minlength")?`Debe tener al menos ${null===(t=n.errors)||void 0===t?void 0:t.minlength.requiredLength} caracteres.`:null!=n&&n.hasError("maxlength")?`Debe tener m\xe1ximo ${null===(a=n.errors)||void 0===a?void 0:a.maxlength.requiredLength} caracteres.`:null!=n&&n.hasError("pattern")?"Formato no v\xe1lido.":""}verificarHistorial(){var e=this;return(0,m.A)(function*(){if(e.HistorialForm.invalid)return void(yield e.toastController.create({message:"Por favor, revise los campos ingresados.",duration:2e3,position:"top"})).present();const t=e.HistorialForm.value.rut;console.log("Buscar historial de compras para RUT:",t),e.router.navigate(["/historial-compras",{rut:t}])})()}consultarHistorial(){this.HistorialForm.invalid?this.presentToast("Por favor ingrese un RUT v\xe1lido."):(this.rut=this.HistorialForm.value.rut,this.cargando=!0,this.productoService.getHistorial(this.rut).subscribe({next:e=>{0===e.length&&this.presentToast("No se encontraron registros en el historial."),this.orders=e,this.orders.forEach(t=>{t.items.forEach(a=>{this.productoService.productoId(a.producto_id).subscribe({next:n=>a.nombre=n.nombre_producto,error:n=>console.error(`No se pudo obtener el producto con ID ${a.producto_id}`)})})}),this.cargando=!1},error:e=>{this.cargando=!1,this.presentToast("Error al obtener el historial."),console.error("Error al obtener el historial:",e)}}))}presentToast(e){var t=this;return(0,m.A)(function*(){(yield t.toastController.create({message:e,duration:2e3,position:"top"})).present()})()}}return(r=i).\u0275fac=function(e){return new(e||r)(o.rXU(l.ok),o.rXU(d.K_),o.rXU(u.Ix),o.rXU(f.P))},r.\u0275cmp=o.VBU({type:r,selectors:[["app-historial-compra"]],decls:40,vars:9,consts:[[3,"fullscreen"],[1,"bigimage"],[1,"container-fluid"],[1,"row","justify-content-center"],["size-md","7","size-lg","6"],["novalidate","",3,"ngSubmit","formGroup"],[1,"titular","datos-cliente-title","text-center",2,"color","black","font-weight","bold"],[1,"g-3",2,"color","black","font-weight","bold"],["size","12"],["position","stacked",1,"form-label"],["name","rut","placeholder","Ej: 12345678","formControlName","rut",1,"input-form",3,"ngModelChange","ngModel"],["class","text-danger",4,"ngIf"],["name","contrasena","placeholder","########","formControlName","contrasena",1,"input-form",3,"ngModelChange","type","ngModel"],[1,"my-2",2,"color","gray"],["type","submit",1,"btn","btn-primary","w-100",3,"click"],[1,"col-md-10","text-center","mt-4"],["class","history-container",4,"ngIf"],["class","text-center mt-4",4,"ngIf"],[1,"footer"],[1,"container"],[1,"float-end"],["href","#",1,"back-to-top"],[1,"footer-text"],["href","#"],[1,"text-danger"],[1,"history-container"],[1,"text-center","titular"],[1,"table-responsive"],[1,"table","table-hover"],["scope","col"],[4,"ngFor","ngForOf"],["scope","row"],[1,"text-center","mt-4"],[1,"text-dark","fw-bold",2,"font-size","1.5rem"]],template:function(e,t){if(1&e&&(o.j41(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"ion-col",4)(5,"form",5),o.bIt("ngSubmit",function(){return t.verificarHistorial()}),o.j41(6,"h4",6),o.EFF(7," Consulta Historial de Compras "),o.k0s(),o.j41(8,"ion-row",7)(9,"ion-col",8)(10,"ion-label",9),o.EFF(11,"RUT"),o.k0s(),o.j41(12,"ion-input",10),o.mxI("ngModelChange",function(n){return o.DH7(t.rut,n)||(t.rut=n),n}),o.k0s(),o.DNE(13,h,2,0,"div",11),o.k0s(),o.j41(14,"ion-col",8)(15,"ion-label",9),o.EFF(16,"Contrase\xf1a"),o.k0s(),o.j41(17,"ion-input",12),o.mxI("ngModelChange",function(n){return o.DH7(t.contrasena,n)||(t.contrasena=n),n}),o.k0s(),o.DNE(18,b,2,0,"div",11),o.k0s()(),o.nrm(19,"hr",13),o.j41(20,"button",14),o.bIt("click",function(){return t.consultarHistorial()}),o.EFF(21,"Consultar Historial"),o.k0s()()(),o.j41(22,"div",15),o.DNE(23,v,21,1,"div",16)(24,P,3,0,"div",17),o.k0s()()()(),o.j41(25,"footer",18)(26,"div",19)(27,"p",20)(28,"a",21),o.EFF(29,"Volver arriba"),o.k0s()(),o.j41(30,"p",22),o.EFF(31," \xa9 2024 "),o.j41(32,"strong"),o.EFF(33,"GreenMarket"),o.k0s(),o.EFF(34," Portafolio. "),o.j41(35,"a",23),o.EFF(36,"Privacidad"),o.k0s(),o.EFF(37," \xb7 "),o.j41(38,"a",23),o.EFF(39,"T\xe9rminos"),o.k0s()()()()()),2&e){let a,n;o.Y8G("fullscreen",!0),o.R7$(5),o.Y8G("formGroup",t.HistorialForm),o.R7$(7),o.R50("ngModel",t.rut),o.R7$(),o.Y8G("ngIf",(null==(a=t.campo("rut"))?null:a.invalid)&&t.campoTocado("rut")),o.R7$(4),o.Y8G("type",t.showPasswordHistorial?"text":"password"),o.R50("ngModel",t.contrasena),o.R7$(),o.Y8G("ngIf",(null==(n=t.campo("contrasena"))?null:n.invalid)&&t.campoTocado("contrasena")),o.R7$(5),o.Y8G("ngIf",t.orders&&t.orders.length>0),o.R7$(),o.Y8G("ngIf",t.orders&&0===t.orders.length)}},dependencies:[g.Sq,g.bT,l.qT,l.BC,l.cb,l.j4,l.JD,d.hU,d.W9,d.$w,d.he,d.ln,d.Gw,g.oe,g.vh],styles:['@charset "UTF-8";.form-container[_ngcontent-%COMP%]{display:flex;justify-content:center;background:#a0d683;color:#000;height:1000px;max-height:100%}.btn-primary[_ngcontent-%COMP%]{background-color:#feff9f;border-color:#a0d683;color:#000}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#72bf78;border-color:#72bf78}.btn-outline-secondary[_ngcontent-%COMP%]{color:#000;border-color:#333}.btn-outline-secondary[_ngcontent-%COMP%]:hover{background-color:#72bf78;color:#000;border-color:#feff9f}.col-md-4[_ngcontent-%COMP%]{margin:0!important}.input-form[_ngcontent-%COMP%]{color:#000;background-color:#a0d683;border:1px solid black;font-weight:700;padding:8px 12px;border-radius:4px;color:gray;font-size:1rem;width:100%;box-sizing:border-box}.history-container[_ngcontent-%COMP%]{padding:20px;color:#000;border-radius:15px;font-weight:700}.bigimage[_ngcontent-%COMP%]{width:100%;min-height:100vh;background:#f5f5f5;margin:0;padding:0}.titular[_ngcontent-%COMP%]{font-family:Bebas Neue,sans-serif;background-color:#72bf78;color:#000;text-align:center;font-weight:700;font-size:34px;padding:10px;border-radius:10px}.label[_ngcontent-%COMP%]{font-weight:700;font-size:18px;color:#000}.text-danger[_ngcontent-%COMP%]{color:red;font-size:14px}.table-header[_ngcontent-%COMP%]{font-weight:700;color:#000;padding:10px 0;border-radius:8px}.table-row[_ngcontent-%COMP%]{background-color:#f9f9f9;color:#000;padding:10px 0;border-bottom:1px solid #ddd;opacity:0;transform:translateY(20px);animation:_ngcontent-%COMP%_slideFadeIn .5s ease forwards}.table-row[_ngcontent-%COMP%]:nth-child(1){animation-delay:.5s}.table-row[_ngcontent-%COMP%]:nth-child(2){animation-delay:1s}.table-row[_ngcontent-%COMP%]:nth-child(3){animation-delay:1.5s}@keyframes _ngcontent-%COMP%_slideFadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.footer[_ngcontent-%COMP%]{background:#72bf78;color:#000;text-align:center;padding:20px 0;box-shadow:0 -4px 10px #0000001a}.footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#feff9f;text-decoration:none;font-weight:700}.footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.footer-text[_ngcontent-%COMP%]{font-size:14px;margin:0}.footer[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#a0d683}.back-to-top[_ngcontent-%COMP%]{background-color:#a0d683;color:#000;padding:8px 12px;border-radius:5px;font-size:12px;font-weight:700;text-decoration:none;transition:all .3s}.back-to-top[_ngcontent-%COMP%]:hover{background-color:#feff9f;color:#000}.table-hover[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#343a40!important}ul[_ngcontent-%COMP%]{padding-left:20px}@media (max-width: 768px){.table[_ngcontent-%COMP%]{font-size:12px}}']}),i})()}];let k=(()=>{var r;class i{}return(r=i).\u0275fac=function(e){return new(e||r)},r.\u0275mod=o.$C({type:r}),r.\u0275inj=o.G2t({imports:[u.iI.forChild(_),u.iI]}),i})(),M=(()=>{var r;class i{}return(r=i).\u0275fac=function(e){return new(e||r)},r.\u0275mod=o.$C({type:r}),r.\u0275inj=o.G2t({imports:[g.MD,l.X1,l.YN,d.bv,k]}),i})()}}]);